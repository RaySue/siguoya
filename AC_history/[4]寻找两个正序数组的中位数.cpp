// ç»™å®šä¸¤ä¸ªå¤§å°ä¸º m å’Œ n çš„æ­£åºï¼ˆä»å°åˆ°å¤§ï¼‰æ•°ç»„ nums1 å’Œ nums2ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›è¿™ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°ã€‚
//
// è¿›é˜¶ï¼šä½ èƒ½è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(log (m+n)) çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//
// è¾“å…¥ï¼šnums1 = [1,3], nums2 = [2]
//è¾“å‡ºï¼š2.00000
//è§£é‡Šï¼šåˆå¹¶æ•°ç»„ = [1,2,3] ï¼Œä¸­ä½æ•° 2
// 
//
// ç¤ºä¾‹ 2ï¼š 
//
// è¾“å…¥ï¼šnums1 = [1,2], nums2 = [3,4]
//è¾“å‡ºï¼š2.50000
//è§£é‡Šï¼šåˆå¹¶æ•°ç»„ = [1,2,3,4] ï¼Œä¸­ä½æ•° (2 + 3) / 2 = 2.5
// 
//
// ç¤ºä¾‹ 3ï¼š 
//
// è¾“å…¥ï¼šnums1 = [0,0], nums2 = [0,0]
//è¾“å‡ºï¼š0.00000
// 
//
// ç¤ºä¾‹ 4ï¼š 
//
// è¾“å…¥ï¼šnums1 = [], nums2 = [1]
//è¾“å‡ºï¼š1.00000
// 
//
// ç¤ºä¾‹ 5ï¼š 
//
// è¾“å…¥ï¼šnums1 = [2], nums2 = []
//è¾“å‡ºï¼š2.00000
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// nums1.length == m 
// nums2.length == n 
// 0 <= m <= 1000 
// 0 <= n <= 1000 
// 1 <= m + n <= 2000 
// -106 <= nums1[i], nums2[i] <= 106 
// 
// Related Topics æ•°ç»„ äºŒåˆ†æŸ¥æ‰¾ åˆ†æ²»ç®—æ³• 
// ğŸ‘ 3466 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
class Solution
{
public:
    // æ–¹æ³•ä¸€ï¼š å½’å¹¶æ’åºï¼Œå°†ä¸¤ä¸ªæ•°ç»„åˆæˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åå†æ±‚ä¸­ä½æ•°
    // Complexity:
    // O(M + N)
    // O(M + N)
    double findMedianSortedArrays(vector<int> &nums1, vector<int> &nums2)
    {
        vector<int> nums(nums1.size() + nums2.size());
        if (nums.empty()) return 0;
        int p1 = nums1.size() - 1;
        int p2 = nums2.size() - 1;
        int p = nums.size() - 1;
        while (p1 >= 0 || p2 >= 0)
        {
            if (p1 < 0)
            {
                nums[p--] = nums2[p2--];
            } else if (p2 < 0)
            {
                nums[p--] = nums1[p1--];
            } else
            {
                if (nums1[p1] < nums2[p2])
                {
                    nums[p--] = nums2[p2--];
                } else
                {
                    nums[p--] = nums1[p1--];
                }
            }
        }

        if (nums.size() % 2 != 0)
        {
            return nums[nums.size() / 2];
        } else
        {
            return (nums[nums.size() / 2 - 1] * 1.0 + nums[nums.size() / 2] * 1.0) / 2;
        }
    }


    // äºŒåˆ·ï¼š 2020.12.25 ä»£ç æ›´ç®€ç»ƒï¼Œæ›´æ˜“æ‡‚
    // æ–¹æ³•äºŒï¼šå¯ä»¥ä¸å½’å¹¶æ’åºï¼Œåªæ˜¯åœ¨ nums1 å’Œ nums2 ä¸­æ‰¾åˆ°ä¸­ä½æ•°çš„ä½ç½®
    // O(M + N)ï¼Œ O(1)
    // æ€è·¯ï¼š
    // æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæŒ‡é’ˆp1 å’Œ p2 åˆ†åˆ«æŒ‡å‘ nums1å’Œ nums2ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†æ‰¾åˆ°ä¸¤ä¸ªæ•°ç»„é•¿åº¦ç›¸åŠ é™¤ä»¥2çš„æ•°
    // æˆ‘ä»¬åˆ©ç”¨ pre å’Œ cur ä¸¤ä¸ªå˜é‡(double)æ¥è®°å½•å¯»æ‰¾ target è¿‡ç¨‹çš„å€¼ï¼Œcurè¡¨ç¤ºå½“å‰å€¼ï¼Œpre æ˜¯å½“å‰æ•°çš„å‰ä¸€ä¸ªæ•°ï¼Œç”¨äºå¶æ•°æ±‚ä¸­ä½æ•°ä½¿ç”¨
    // å½“ p1 å’Œ p2 ç›¸åŠ ç­‰äº targetçš„æ—¶å€™ï¼Œå¦‚æœæ˜¯å¥‡æ•°é‚£ä¹ˆcurå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ä¸­ä½æ•°ï¼Œå¦‚æœæ˜¯å¶æ•°ï¼Œé‚£ä¹ˆ(pre + cur) /2å°±æ˜¯ä¸­ä½æ•°
    // é‡Œé¢çš„åˆ¤æ–­æ¡ä»¶å°±æ˜¯å½’å¹¶æ’åºçš„åˆ¤æ–­æ¡ä»¶ï¼Œåƒä¸‡ä¸è¦æƒ³å¤æ‚ï¼Œéµå¾ªä»¥ä¸‹æ€è·¯ï¼š
    // 1. å¦‚æœ nums2 éå†å®Œäº†å³ p2 >= nums2.size()ï¼Œé‚£ä¹ˆå°±åªèƒ½éå† nums1
    // 2. å¦‚æœ nums1 éå†å®Œäº†å³ p1 >= nums1.size()ï¼Œé‚£ä¹ˆå°±åªèƒ½éå† nums2
    // 3. å‰©ä¸‹çš„æƒ…å†µæ˜¯ä¸¤è€…éƒ½æ²¡æœ‰éå†å®Œï¼Œé‚£ä¹ˆå°±æ¯”è¾ƒå¤§å°æ¥åˆ¤æ–­å³å¯
    // ä¸éœ€è¦è¿›è¡Œ çœŸæ­£çš„å½’å¹¶åˆå¹¶ï¼Œ æˆ‘ä»¬åªéœ€æ‰¾åˆ° æ€»é•¿åº¦ ä¸€èˆ¬çš„ä½ç½®çš„æ•°ï¼ŒåŠå…¶å‰ä¸€ä¸ªä½ç½®çš„æ•°ï¼ˆå¤„ç†å¶æ•°æƒ…å†µï¼‰
    // ç¬¬ K ä¸ªå…ƒç´ 
    double findMedianSortedArrays2(vector<int> &nums1, vector<int> &nums2)
    {
        int p1 = 0, p2 = 0;
        int target = (nums1.size() + nums2.size()) / 2;
        int cur = 0, pre = 0;
        while (p1 + p2 < target)
        {
            pre = cur;
            if (p1 >= nums1.size())
            {
                cur = nums2[p2++];
            } else if (p2 >= nums2.size())
            {
                cur = nums1[p1++];
            } else
            {
                cur = nums1[p1] < nums2[p2] ? nums1[p1++] : nums2[p2++];
            }
        }
        return ((nums1.size() + nums2.size()) % 2 == 0) ? (cur * 1.0 + pre * 1.0) / 2 : cur;
    }

    // --------------------------------------------------------------------------------------------

    // æ–¹æ³•ä¸‰ï¼šéƒ½æ˜¯æ’åºçš„æ•°ç»„ï¼ŒäºŒåˆ†æ³•æ‰¾ç¬¬kä¸ªå¤§çš„æ•°
    double findMedianSortedArrays(vector<int>& nums1, vector<int>& nums2)
    {
        int m = nums1.size();
        int n = nums2.size();
        // ä¸­ä½æ•° = ï¼ˆleft + rightï¼‰/2, left å’Œ right å¯èƒ½æ˜¯ç›¸ç­‰çš„
        // m + n å¦‚æœæ˜¯å¥‡æ•°çš„è¯ï¼Œé‚£ä¹ˆä¸‹é¢ä¸¤ä¸ªå€¼æ˜¯ç›¸ç­‰çš„ï¼Œå¶æ•°æ—¶å€™ä¸ç›¸ç­‰
        int left = (m + n + 1) / 2;
        int right = (m + n + 2) / 2;
        return (findKth(nums1, 0, nums2, 0, left) + findKth(nums1, 0, nums2, 0, right)) / 2.0;
    }

    //åœ¨ä¸¤ä¸ªæœ‰åºæ•°ç»„ä¸­æ‰¾åˆ°ç¬¬kä¸ªå…ƒç´ ï¼ˆä¾‹å¦‚æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œk=1ï¼Œå³nums[0]ï¼‰
    //i: nums1çš„èµ·å§‹ä½ç½® j: nums2çš„èµ·å§‹ä½ç½®ï¼ˆiï¼Œjéƒ½æ˜¯ä»0å¼€å§‹ï¼‰
    int findKth(vector<int>& nums1, int p1, vector<int>& nums2, int p2, int k)
    {
        //è‹¥nums1ä¸ºç©ºï¼ˆæˆ–æ˜¯è¯´å…¶ä¸­æ•°å­—å…¨è¢«æ·˜æ±°äº†ï¼‰
        //åœ¨nums2ä¸­æ‰¾ç¬¬kä¸ªå…ƒç´ ï¼Œæ­¤æ—¶nums2èµ·å§‹ä½ç½®æ˜¯jï¼Œæ‰€ä»¥æ˜¯j+k-1
        if(p1 >= nums1.size()) return nums2[p2 + k - 1];
        //nums2åŒç†
        if(p2 >= nums2.size()) return nums1[p1 + k - 1];

        //é€’å½’å‡ºå£ï¼Œå°±æ˜¯æ±‚ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„æœ€å°å€¼
        if(k == 1) return min(nums1[p1], nums2[p2]);

        //è¿™ä¸¤ä¸ªæ•°ç»„çš„ç¬¬K/2å°çš„æ•°å­—ï¼Œè‹¥ä¸è¶³k/2ä¸ªæ•°å­—åˆ™èµ‹å€¼æ•´å‹æœ€å¤§å€¼ï¼Œä»¥ä¾¿æ·˜æ±°å¦ä¸€æ•°ç»„çš„å‰k/2ä¸ªæ•°å­—
        int midVal1 = (p1 + k/2 - 1 < nums1.size()) ? nums1[p1 + k/2 - 1] : INT_MAX;
        int midVal2 = (p2 + k/2 - 1 < nums2.size()) ? nums2[p2 + k/2 - 1] : INT_MAX;
        //äºŒåˆ†æ³•æ ¸å¿ƒéƒ¨åˆ†
        if(midVal1 < midVal2)
            return findKth(nums1, p1 + k/2, nums2, p2, k - k/2);
        else
            return findKth(nums1, p1, nums2, p2 + k/2, k - k/2);
    }

};
//leetcode submit region end(Prohibit modification and deletion)
